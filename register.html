<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>新規登録 | 神戸芸術センター・スタジオWEB予約</title>
  <style>
    body {
      font-family: "Helvetica Neue", Arial, sans-serif;
      background-color: #0a1a2f;
      color: #fff;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .register-container {
      background-color: rgba(255,255,255,0.08);
      padding: 30px 40px;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(255,255,255,0.1);
      width: 360px;
    }
    h2 {
      text-align: center;
      margin-bottom: 25px;
    }
    label {
      display: block;
      margin-top: 12px;
      font-size: 14px;
    }
    input, select {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
    }
    button {
      width: 100%;
      background: radial-gradient(circle at center, rgba(255,255,255,0.25), rgba(255,255,255,0.05));
      color: white;
      border: none;
      border-radius: 8px;
      padding: 10px;
      margin-top: 20px;
      font-size: 16px;
      cursor: pointer;
      box-shadow: 0 0 8px rgba(255,255,255,0.2);
      transition: 0.3s;
    }
    button:hover {
      box-shadow: 0 0 14px rgba(255,255,255,0.5);
    }
    .login-link {
      text-align: center;
      margin-top: 15px;
      font-size: 14px;
    }
    .login-link a {
      color: #89cfff;
      text-decoration: underline;
    }
    .error {
      color: #ff8080;
      font-size: 13px;
      margin-top: 10px;
      text-align: center;
    }
  </style>
</head>
<body>

  <div class="register-container">
    <h2>神戸芸術センター・スタジオWEB予約 新規登録</h2>
    <form id="registerForm">
      <label>氏名 *</label>
      <input type="text" id="name" required>

      <label>団体名（任意）</label>
      <input type="text" id="organization">

      <label>住所 *</label>
      <input type="text" id="address" required>

      <label>電話番号 *</label>
      <input type="tel" id="phone" required>

      <label>利用内容のジャンル *</label>
      <input type="text" id="genre" required>

      <label>メールアドレス *</label>
      <input type="email" id="email" required>

      <label>パスワード *</label>
      <input type="password" id="password" minlength="8" required placeholder="英数字8文字以上">

      <button type="submit">登録</button>
      <div class="error" id="errorMsg"></div>
    </form>
    <div class="login-link">
      すでに登録済みの方は <a href="login.html">ログイン</a>
    </div>
  </div>

 <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
  import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyA4es-RnZfGenUPgJDzDFQaIh1LBNZRxYc",
    authDomain: "studio-rental-180df.firebaseapp.com",
    projectId: "studio-rental-180df",
    storageBucket: "studio-rental-180df.firebasestorage.app",
    messagingSenderId: "485178815055",
    appId: "1:485178815055:web:f91792229f8c359cf1303a",
    measurementId: "G-EF147DP6ZB"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);


    const registerForm = document.getElementById("registerForm");
    const errorMsg = document.getElementById("errorMsg");

    registerForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      const name = document.getElementById("name").value.trim();
      const organization = document.getElementById("organization").value.trim();
      const address = document.getElementById("address").value.trim();
      const phone = document.getElementById("phone").value.trim();
      const genre = document.getElementById("genre").value.trim();
      const email = document.getElementById("email").value.trim();
      const password = document.getElementById("password").value;

      // パスワードバリデーション
      if (!/(?=.*[a-zA-Z])(?=.*\d)[A-Za-z\d]{8,}/.test(password)) {
        errorMsg.textContent = "パスワードは英数字8文字以上で、英字と数字を含めてください。";
        return;
      }

      try {
        const userCredential = await auth.createUserWithEmailAndPassword(email, password);
        const user = userCredential.user;
        await db.collection("users").doc(user.uid).set({
          name, organization, address, phone, genre, email, createdAt: new Date()
        });
        alert("登録が完了しました！");
        window.location.href = "index.html";
      } catch (error) {
        errorMsg.textContent = error.message;
      }
    });
  </script>
</body>
</html>
