<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ–°è¦ç™»éŒ² | ç¥æˆ¸èŠ¸è¡“ã‚»ãƒ³ã‚¿ãƒ¼ãƒ»ã‚¹ã‚¿ã‚¸ã‚ªWEBäºˆç´„</title>
  <style>
    body {
      font-family: "Helvetica Neue", Arial, sans-serif;
      background-color: #0a1a2f;
      color: #fff;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .register-container {
      background-color: rgba(255,255,255,0.08);
      padding: 30px 40px;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(255,255,255,0.1);
      width: 360px;
    }
    h2 {
      text-align: center;
      margin-bottom: 25px;
    }
    label {
      display: block;
      margin-top: 12px;
      font-size: 14px;
    }
    input, select {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
    }
    button {
      width: 100%;
      background: radial-gradient(circle at center, rgba(255,255,255,0.25), rgba(255,255,255,0.05));
      color: white;
      border: none;
      border-radius: 8px;
      padding: 10px;
      margin-top: 20px;
      font-size: 16px;
      cursor: pointer;
      box-shadow: 0 0 8px rgba(255,255,255,0.2);
      transition: 0.3s;
    }
    button:hover {
      box-shadow: 0 0 14px rgba(255,255,255,0.5);
    }
    .login-link {
      text-align: center;
      margin-top: 15px;
      font-size: 14px;
    }
    .login-link a {
      color: #89cfff;
      text-decoration: underline;
    }
    .error {
      color: #ff8080;
      font-size: 13px;
      margin-top: 10px;
      text-align: center;
    }
  </style>
</head>
<body>

  <div class="register-container">
    <h2>ç¥æˆ¸èŠ¸è¡“ã‚»ãƒ³ã‚¿ãƒ¼ãƒ»ã‚¹ã‚¿ã‚¸ã‚ªWEBäºˆç´„ æ–°è¦ç™»éŒ²</h2>
    <form id="registerForm">
      <label>æ°å *</label>
      <input type="text" id="name" required>

      <label>å›£ä½“åï¼ˆä»»æ„ï¼‰</label>
      <input type="text" id="organization">

      <label>ä½æ‰€ *</label>
      <input type="text" id="address" required>

      <label>é›»è©±ç•ªå· *</label>
      <input type="tel" id="phone" required>

      <label>åˆ©ç”¨å†…å®¹ã®ã‚¸ãƒ£ãƒ³ãƒ« *</label>
      <input type="text" id="genre" required>

      <label>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ *</label>
      <input type="email" id="email" required>

      <label>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ *</label>
      <input type="password" id="password" minlength="8" required placeholder="è‹±æ•°å­—8æ–‡å­—ä»¥ä¸Š">

      <button type="submit">ç™»éŒ²</button>
      <div class="error" id="errorMsg"></div>
    </form>
    <div class="login-link">
      ã™ã§ã«ç™»éŒ²æ¸ˆã¿ã®æ–¹ã¯ <a href="login.html">ãƒ­ã‚°ã‚¤ãƒ³</a>
    </div>
  </div>

<!-- Firebase SDK -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
  import { getFirestore, setDoc, doc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyA4es-RnZfGenUPgJDzDFQaIh1LBNZRxYc",
    authDomain: "studio-rental-180df.firebaseapp.com",
    projectId: "studio-rental-180df",
    storageBucket: "studio-rental-180df.firebasestorage.app",
    messagingSenderId: "485178815055",
    appId: "1:485178815055:web:f91792229f8c359cf1303a",
    measurementId: "G-EF147DP6ZB"
  };

  // Firebase åˆæœŸåŒ–
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  // ç™»éŒ²å‡¦ç†
  const registerForm = document.getElementById("registerForm");
  const errorMsg = document.getElementById("errorMsg");

  registerForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    const name = document.getElementById("name").value.trim();
    const organization = document.getElementById("organization").value.trim();
    const address = document.getElementById("address").value.trim();
    const phone = document.getElementById("phone").value.trim();
    const genre = document.getElementById("genre").value.trim();
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value;

    // ğŸ” ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
    if (!/(?=.*[a-zA-Z])(?=.*\d)[A-Za-z\d]{8,}/.test(password)) {
      errorMsg.textContent = "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯è‹±æ•°å­—8æ–‡å­—ä»¥ä¸Šã§ã€è‹±å­—ã¨æ•°å­—ã‚’å«ã‚ã¦ãã ã•ã„ã€‚";
      return;
    }

    try {
      // âœ… æ–°è¦ç™»éŒ²
      const userCredential = await createUserWithEmailAndPassword(auth, email, password);
      const user = userCredential.user;

      // âœ… Firestore ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ä¿å­˜
      await setDoc(doc(db, "users", user.uid), {
        name,
        organization,
        address,
        phone,
        genre,
        email,
        createdAt: new Date(),
      });

      alert("ç™»éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸï¼");
      window.location.href = "index.html";
    } catch (error) {
      errorMsg.textContent = "ã‚¨ãƒ©ãƒ¼ï¼š" + error.message;
    }
  });
</script>

</body>
</html>
